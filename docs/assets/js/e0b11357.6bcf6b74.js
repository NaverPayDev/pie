"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2295],{7411:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>l,toc:()=>d});var r=i(5723),t=i(4639);const s={},a="safe-html-react-parser",l={id:"@naverpay/safe-html-react-parser/README",title:"safe-html-react-parser",description:"A secure wrapper for html-react-parser with DOMPurify that automatically sanitizes HTML before parsing.",source:"@site/docs/@naverpay/safe-html-react-parser/README.md",sourceDirName:"@naverpay/safe-html-react-parser",slug:"/@naverpay/safe-html-react-parser/",permalink:"/pie/docs/@naverpay/safe-html-react-parser/",draft:!1,unlisted:!1,editUrl:"https://github.com/NaverPayDev/pie/tree/main/packages/@naverpay/safe-html-react-parser/README.md",tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"\uac1c\uc120\uc0ac\ud56d",permalink:"/pie/docs/@naverpay/react-pdf/\uac1c\uc120\uc0ac\ud56d"},next:{title:"@naverpay/svg-manager",permalink:"/pie/docs/@naverpay/svg-manager/"}},o={},d=[{value:"What it does",id:"what-it-does",level:2},{value:"Installation",id:"installation",level:2},{value:"Choosing a DOM Implementation (Server-Side Only)",id:"choosing-a-dom-implementation-server-side-only",level:3},{value:"Basic Usage",id:"basic-usage",level:2},{value:"API",id:"api",level:2},{value:"<code>safeParse(htmlString, options?)</code>",id:"safeparsehtmlstring-options",level:3},{value:"Parameters",id:"parameters",level:4},{value:"Options",id:"options",level:4},{value:"Returns",id:"returns",level:4},{value:"Advanced Usage",id:"advanced-usage",level:2},{value:"Custom Sanitization Config",id:"custom-sanitization-config",level:3},{value:"Preserving Custom Tags",id:"preserving-custom-tags",level:3},{value:"Using with html-react-parser Options",id:"using-with-html-react-parser-options",level:3},{value:"Configuring DOM Implementation (Server-Side)",id:"configuring-dom-implementation-server-side",level:3},{value:"Method 1: Per-call configuration (Recommended)",id:"method-1-per-call-configuration-recommended",level:4},{value:"Method 2: Global configuration",id:"method-2-global-configuration",level:4},{value:"Default Allowed Tags",id:"default-allowed-tags",level:2},{value:"Performance Optimization",id:"performance-optimization",level:2},{value:"Caching",id:"caching",level:3},{value:"Memory Management",id:"memory-management",level:3},{value:"DOM Implementation Comparison",id:"dom-implementation-comparison",level:3},{value:"Security Notes",id:"security-notes",level:2},{value:"Built with",id:"built-with",level:2},{value:"License",id:"license",level:2}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"safe-html-react-parser",children:"safe-html-react-parser"}),"\n",(0,r.jsxs)(n.p,{children:["A secure wrapper for ",(0,r.jsx)(n.strong,{children:"html-react-parser"})," with ",(0,r.jsx)(n.strong,{children:"DOMPurify"})," that automatically sanitizes HTML before parsing."]}),"\n",(0,r.jsx)(n.h2,{id:"what-it-does",children:"What it does"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\ud83d\udee1\ufe0f ",(0,r.jsx)(n.strong,{children:"Security"}),": Automatically sanitizes malicious HTML using DOMPurify"]}),"\n",(0,r.jsxs)(n.li,{children:["\u269b\ufe0f ",(0,r.jsx)(n.strong,{children:"React"}),": Seamlessly integrates with html-react-parser"]}),"\n",(0,r.jsxs)(n.li,{children:["\ud83c\udf10 ",(0,r.jsx)(n.strong,{children:"Universal"}),": Works in both browser and Node.js (SSR) environments"]}),"\n",(0,r.jsxs)(n.li,{children:["\ud83c\udff7\ufe0f ",(0,r.jsx)(n.strong,{children:"Custom Tags"}),": Handles project-specific tags like ",(0,r.jsx)(n.code,{children:"<custom>"})," safely"]}),"\n",(0,r.jsxs)(n.li,{children:["\ud83d\ude80 ",(0,r.jsx)(n.strong,{children:"Flexible"}),": Choose your DOM implementation (jsdom, happy-dom, or linkedom)"]}),"\n",(0,r.jsxs)(n.li,{children:["\u26a1 ",(0,r.jsx)(n.strong,{children:"Optimized"}),": Built-in caching and memory management"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm install @naverpay/safe-html-react-parser\n"})}),"\n",(0,r.jsx)(n.h3,{id:"choosing-a-dom-implementation-server-side-only",children:"Choosing a DOM Implementation (Server-Side Only)"}),"\n",(0,r.jsx)(n.p,{children:"For server-side rendering, you need to install one of the following DOM implementations:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Option 1: jsdom (most complete, heavier)\nnpm install jsdom\n\n# Option 2: happy-dom (faster, lighter, recommended)\nnpm install happy-dom\n\n# Option 3: linkedom (fastest, lightest)\nnpm install linkedom\n"})}),"\n",(0,r.jsx)(n.p,{children:"The library will automatically detect and use the first available implementation in this order: jsdom \u2192 happy-dom \u2192 linkedom."}),"\n",(0,r.jsx)(n.h2,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import { safeParse } from '@naverpay/safe-html-react-parser'\n\n// Basic usage - automatically sanitizes dangerous HTML\nconst Component = () => {\n  const maliciousHtml = '<p>Hello <script>alert(\"XSS\")<\/script>World</p>'\n  return <div>{safeParse(maliciousHtml)}</div>\n}\n// Result: <div><p>Hello World</p></div>\n"})}),"\n",(0,r.jsx)(n.h2,{id:"api",children:"API"}),"\n",(0,r.jsx)(n.h3,{id:"safeparsehtmlstring-options",children:(0,r.jsx)(n.code,{children:"safeParse(htmlString, options?)"})}),"\n",(0,r.jsx)(n.p,{children:"Parses HTML string into React elements with automatic XSS protection."}),"\n",(0,r.jsx)(n.h4,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"htmlString"})," (string): The HTML string to parse"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"options"})," (SafeParseOptions, optional): Configuration options"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"options",children:"Options"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"interface SafeParseOptions extends HTMLReactParserOptions {\n  // DOMPurify configuration\n  sanitizeConfig?: DOMPurify.Config\n  \n  // Custom tags to preserve during sanitization\n  preserveCustomTags?: string[]\n}\n"})}),"\n",(0,r.jsx)(n.h4,{id:"returns",children:"Returns"}),"\n",(0,r.jsx)(n.p,{children:"React elements or array of React elements"}),"\n",(0,r.jsx)(n.h2,{id:"advanced-usage",children:"Advanced Usage"}),"\n",(0,r.jsx)(n.h3,{id:"custom-sanitization-config",children:"Custom Sanitization Config"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import { safeParse } from '@naverpay/safe-html-react-parser'\n\nconst html = '<div class=\"content\"><style>body{color:red}</style><p>Text</p></div>'\n\nconst result = safeParse(html, {\n  sanitizeConfig: {\n    ALLOWED_TAGS: ['div', 'p', 'style'], // Allow style tags\n    ALLOWED_ATTR: ['class'],\n    ALLOW_ARIA_ATTR: true\n  }\n})\n"})}),"\n",(0,r.jsx)(n.h3,{id:"preserving-custom-tags",children:"Preserving Custom Tags"}),"\n",(0,r.jsxs)(n.p,{children:["Use ",(0,r.jsx)(n.code,{children:"preserveCustomTags"})," to preserve project-specific tags that would otherwise be removed:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import { safeParse } from '@naverpay/safe-html-react-parser'\n\n// Preserve custom tags like <g>, <path>, etc.\nconst svgContent = '<g><path d=\"M10,10 L20,20\"/></g>'\n\nconst result = safeParse(svgContent, {\n  preserveCustomTags: ['g', 'path'],\n  replace: (domNode) => {\n    if (domNode.name === 'g') {\n      return <g {...domNode.attribs}>{/* custom rendering */}</g>\n    }\n    if (domNode.name === 'path') {\n      return <path {...domNode.attribs} />\n    }\n  }\n})\n"})}),"\n",(0,r.jsx)(n.h3,{id:"using-with-html-react-parser-options",children:"Using with html-react-parser Options"}),"\n",(0,r.jsx)(n.p,{children:"All html-react-parser options are supported:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:'import { safeParse } from \'@naverpay/safe-html-react-parser\'\n\nconst html = \'<div id="content"><p>Hello</p><img src="image.jpg" alt="test"/></div>\'\n\nconst result = safeParse(html, {\n  replace: (domNode) => {\n    if (domNode.name === \'img\') {\n      return <img {...domNode.attribs} loading="lazy" />\n    }\n  },\n  trim: true\n})\n'})}),"\n",(0,r.jsx)(n.h3,{id:"configuring-dom-implementation-server-side",children:"Configuring DOM Implementation (Server-Side)"}),"\n",(0,r.jsx)(n.p,{children:"You have two ways to configure the DOM implementation:"}),"\n",(0,r.jsx)(n.h4,{id:"method-1-per-call-configuration-recommended",children:"Method 1: Per-call configuration (Recommended)"}),"\n",(0,r.jsxs)(n.p,{children:["Pass ",(0,r.jsx)(n.code,{children:"domPurifyOptions"})," directly to ",(0,r.jsx)(n.code,{children:"safeParse()"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import { safeParse } from '@naverpay/safe-html-react-parser'\nimport { Window } from 'happy-dom'\n\nconst result = safeParse(htmlString, {\n  domPurifyOptions: {\n    domWindowFactory: () => new Window(),\n    enableCache: true,\n    maxCacheSize: 100\n  }\n})\n"})}),"\n",(0,r.jsx)(n.h4,{id:"method-2-global-configuration",children:"Method 2: Global configuration"}),"\n",(0,r.jsx)(n.p,{children:"Configure once at app initialization:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import { configureDOMPurify } from '@naverpay/safe-html-react-parser'\n\n// Using jsdom\nimport { JSDOM } from 'jsdom'\nconfigureDOMPurify({\n  domWindowFactory: () => new JSDOM('<!DOCTYPE html>'),\n  enableCache: true,\n  maxCacheSize: 100,\n  recreateInterval: 1000 // Recreate DOM instance every 1000 sanitizations\n})\n\n// Using happy-dom (recommended for better performance)\nimport { Window } from 'happy-dom'\nconfigureDOMPurify({\n  domWindowFactory: () => new Window(),\n  enableCache: true,\n  recreateInterval: 500\n})\n\n// Using linkedom (fastest, minimal footprint)\nimport { parseHTML } from 'linkedom'\nconfigureDOMPurify({\n  domWindowFactory: () => parseHTML('<!DOCTYPE html>'),\n  enableCache: true\n})\n"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"[!NOTE]"}),"\n",(0,r.jsx)(n.p,{children:"If you don't configure anything, the library will automatically try jsdom \u2192 happy-dom \u2192 linkedom in that order."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"default-allowed-tags",children:"Default Allowed Tags"}),"\n",(0,r.jsx)(n.p,{children:"By default, the following HTML tags are allowed:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"ALLOWED_TAGS: [\n  'p', 'br', 'strong', 'em', 'b', 'i', 'u', 'span', 'div',\n  'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'h',\n  'ul', 'ol', 'li', 'dl', 'dt', 'dd',\n  'a', 'img'\n]\n"})}),"\n",(0,r.jsx)(n.h2,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,r.jsx)(n.h3,{id:"caching",children:"Caching"}),"\n",(0,r.jsx)(n.p,{children:"By default, caching is enabled to improve performance:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"configureDOMPurify({\n  enableCache: true,      // Default: true\n  maxCacheSize: 100,      // Default: 100\n})\n"})}),"\n",(0,r.jsx)(n.h3,{id:"memory-management",children:"Memory Management"}),"\n",(0,r.jsx)(n.p,{children:"The DOM instance is automatically recreated periodically to prevent memory leaks:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"configureDOMPurify({\n  recreateInterval: 1000  // Default: 1000 sanitization calls\n})\n"})}),"\n",(0,r.jsx)(n.h3,{id:"dom-implementation-comparison",children:"DOM Implementation Comparison"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Implementation"}),(0,r.jsx)(n.th,{children:"Speed"}),(0,r.jsx)(n.th,{children:"Memory"}),(0,r.jsx)(n.th,{children:"Completeness"}),(0,r.jsx)(n.th,{children:"Recommended For"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"jsdom"})}),(0,r.jsx)(n.td,{children:"Slower"}),(0,r.jsx)(n.td,{children:"Higher"}),(0,r.jsx)(n.td,{children:"Most complete"}),(0,r.jsx)(n.td,{children:"Maximum compatibility"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"happy-dom"})}),(0,r.jsx)(n.td,{children:"Fast"}),(0,r.jsx)(n.td,{children:"Medium"}),(0,r.jsx)(n.td,{children:"Good"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Balanced (Recommended)"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"linkedom"})}),(0,r.jsx)(n.td,{children:"Fastest"}),(0,r.jsx)(n.td,{children:"Lowest"}),(0,r.jsx)(n.td,{children:"Basic"}),(0,r.jsx)(n.td,{children:"Performance-critical apps"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"security-notes",children:"Security Notes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"All HTML is sanitized by DOMPurify before parsing"}),"\n",(0,r.jsxs)(n.li,{children:["Dangerous tags like ",(0,r.jsx)(n.code,{children:"<script>"}),", ",(0,r.jsx)(n.code,{children:"<iframe>"}),", ",(0,r.jsx)(n.code,{children:"<object>"})," are automatically removed"]}),"\n",(0,r.jsxs)(n.li,{children:["Event handlers like ",(0,r.jsx)(n.code,{children:"onclick"}),", ",(0,r.jsx)(n.code,{children:"onload"})," are stripped out"]}),"\n",(0,r.jsx)(n.li,{children:"Only safe attributes are preserved by default"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"built-with",children:"Built with"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/remarkablemark/html-react-parser",children:"html-react-parser@^5.2.7"})," - HTML string to React element parser"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/cure53/DOMPurify",children:"dompurify@^3.3.0"})," - XSS sanitizer"]}),"\n",(0,r.jsxs)(n.li,{children:["Optional: ",(0,r.jsx)(n.a,{href:"https://github.com/jsdom/jsdom",children:"jsdom"}),", ",(0,r.jsx)(n.a,{href:"https://github.com/capricorn86/happy-dom",children:"happy-dom"}),", or ",(0,r.jsx)(n.a,{href:"https://github.com/WebReflection/linkedom",children:"linkedom"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"license",children:"License"}),"\n",(0,r.jsx)(n.p,{children:"MIT"})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},4639:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>l});var r=i(2155);const t={},s=r.createContext(t);function a(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);